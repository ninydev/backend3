jQuery(document).ready(function(w){"use strict";var n={initDone:!1,languageSelectorBoxDelta:0,oldLanguageSelector:!1,languageSelectorEnabled:!0,parseBool:function(e){return!/^(false|0)$/i.test(e)&&!!e},isOldLanguageSelector:function(){return n.oldLanguageSelector},isPostDisabled:function(){return WPGlobusGutenberg.__post.disabled},init:function(){WPGlobusGutenberg.yoastSeo=n.parseBool(WPGlobusGutenberg.yoastSeo),n.isPostDisabled()||(n.initListeners(),n.setTabs(),n.formHandler(),n.attachListeners())},initListeners:function(){WPGlobusGutenberg.yoastSeo&&1==w(".yoast.wpseo-metabox").length&&w(window).on("beforeunload",function(e){e.stopImmediatePropagation()})},formHandler:function(){var e=w(".metabox-base-form #referredby").attr("value");void 0!==e&&(e=-1==e.indexOf("language=en")?e+"&language="+WPGlobusGutenberg.language:e.replace("language=en","language="+WPGlobusGutenberg.language),w(".metabox-base-form #referredby").attr("value",e)),void 0!==(e=w('input[name="_wp_original_http_referer"]').attr("value"))&&(e=-1==e.indexOf("language=en")?e+"&language="+WPGlobusGutenberg.language:e.replace("language=en","language="+WPGlobusGutenberg.language),w('input[name="_wp_original_http_referer"]').attr("value",e))},setTabs:function(){if(0!=WPGlobusGutenberg.tabs.length){n.oldLanguageSelector=!0;var t=setInterval(function(){var e=w(".edit-post-header__settings");1==e.length&&(e.before(WPGlobusGutenberg.tabs),clearInterval(t))},200)}else n.initWPGlobusPlugin()},setSelectorStatus:function(){if(n.isOldLanguageSelector()){w(".wpglobus-gutenberg-selector-box").css({opacity:"0.2"}).attr("onclick","return false;"),n.languageSelectorEnabled=!1;var e=setInterval(function(){if(0==w(".is-saving").length){if(clearInterval(e),WPGlobusGutenberg.pagenow==WPGlobusGutenberg.postNewPage&&-1!=location.pathname.indexOf(WPGlobusGutenberg.postEditPage))return WPGlobusGutenberg.pagenow=WPGlobusGutenberg.postEditPage,w(".wpglobus-gutenberg-selector-box").css({opacity:"1"}).attr("onclick",""),void n.reloadPage();n.languageSelectorEnabled=!0,w(".wpglobus-gutenberg-selector-box").css({opacity:"1"}).attr("onclick","")}},400)}},reloadPage:function(){w(".wpglobus-selector-grid").css({"grid-template-columns":"10% 90%"}),w(".wpglobus-gutenberg-selector-text").text(WPGlobusGutenberg.i18n.reload),function e(){w(".wpglobus-gutenberg-selector").fadeOut(500).fadeIn(500,e)}(),setTimeout(function(){location.reload()},500)},attachListeners:function(){n.isOldLanguageSelector()&&(w(document).on("mouseenter",".wpglobus-gutenberg-selector",function(e){n.languageSelectorEnabled&&(w(".wpglobus-gutenberg-selector-dropdown").css({display:"block"}),n.languageSelectorBoxDelta=e.screenY,w(".edit-post-header").css({"z-index":"100000"}),w(".wpglobus-gutenberg-selector-box").css({"z-index":"100001"}))}),w(document).on("mouseleave",".wpglobus-gutenberg-selector",function(e){0!=n.languageSelectorBoxDelta&&e.screenY-n.languageSelectorBoxDelta<=0&&(w(".wpglobus-gutenberg-selector-dropdown").css({display:"none"}),w(".edit-post-header").css({"z-index":"9989"}),w(".wpglobus-gutenberg-selector-box").css({"z-index":"100"}))}),w(document).on("mouseleave",".wpglobus-gutenberg-selector-dropdown",function(e){w(".wpglobus-gutenberg-selector-dropdown").css({display:"none"}),w(".edit-post-header").css({"z-index":"9989"}),w(".wpglobus-gutenberg-selector-box").css({"z-index":"10000"})}),w(document).on("click",".editor-post-save-draft",function(){n.setSelectorStatus()}),w(document).on("click",".editor-post-publish-button",function(){n.setSelectorStatus()}))},initWPGlobusPlugin:function(){var e=WPGlobusGutenberg.language,t=WPGlobusCoreData.enabled_languages,n=WPGlobusCoreData.en_language_name,o=WPGlobusGutenberg.flags_url,l=location.href,a={};for(var s in t)-1==l.indexOf("language="+e)?a[t[s]]=l+"&language="+t[s]:a[t[s]]=l.replace("language="+e,"language="+t[s]);var u=wp.i18n.__,r=wp.element.createElement,g=wp.element.Fragment,i=wp.components.Notice,b=wp.components.Button,c=(wp.components,wp.editPost.PluginSidebarMoreMenuItem),d=wp.components.PanelBody,p=wp.editPost.PluginSidebar,m=wp.plugins.registerPlugin,G=w(".components-panel__header.edit-post-sidebar-header button.components-icon-button").eq(0);function f(){setTimeout(function(){for(var e=document.getElementsByClassName("components-icon-button"),t=0;t<e.length;t++){var n=e[t].getAttribute("aria-label");if(null!==n&&-1!=n.indexOf("WPGlobus"))if(void 0===e[t].dataset.done){var o=e[t].innerHTML;e[t].innerHTML=o+'<img height="20px" width="20px" src="'+WPGlobusGutenberg.flags_url[WPGlobusGutenberg.language]+'" />&nbsp;'+WPGlobusAdmin.data.en_language_name[WPGlobusGutenberg.language],e[t].dataset.done="yes"}}},300)}function P(){return r("div",{},r(i,{className:"wpglobus-block-editor-panel__notice",status:"informational",isDismissible:!1},u("Select language")),r("div",{className:"wpglobus-block-editor-panel__switcher-box"},WPGlobusGutenberg.pagenow==WPGlobusGutenberg.postNewPage?r("div",{style:{marginBottom:"20px"},className:"wpglobus-block-editor-panel__switcher-notice"},WPGlobusGutenberg.i18n.save_post):r("ul",{className:"language-list"},t.map(function(e){return r("li",{key:e,className:"language-item"},r("img",{style:{marginRight:"7px"},className:"wpglobus-block-editor-panel__flag",height:"20px",width:"20px",src:o[e]}),r(b,{href:a[e],isSmall:!0,isPrimary:!0},n[e]))}))),r(b,{className:"wpglobus-block-editor-panel__button-link wpglobus-block-editor-panel__info",href:WPGlobusGutenberg.store_link,isLink:!0,target:"_blank"},u("WPGlobus Premium Add-ons")),r(b,{className:"wpglobus-block-editor-panel__button-link wpglobus-block-editor-panel__settings-link",href:WPGlobusGutenberg.block_editor_tab_url,isLink:!0},u("Settings")))}w(document).on("click",G,function(){f()}),m("wpglobus-block-editor",{icon:"",render:function(){return f(),r(g,{},r(c,{target:"wpglobus-block-editor-sidebar",icon:"admin-site"},u("WPGlobus")),r(p,{name:"wpglobus-block-editor-sidebar",title:"WPGlobus",className:"wpglobus-block-editor-components-panel"},r(d,{className:"wpglobus-block-editor-panel__body"},P())))}})}};WPGlobusGutenberg=w.extend({},WPGlobusGutenberg,n),WPGlobusGutenberg.init()});